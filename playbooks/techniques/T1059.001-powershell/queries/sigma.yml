title: Encoded PowerShell Command
id: f1234567-ps-encoded-detect-001
status: production
level: high
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        Image|endswith:
            - '\powershell.exe'
            - '\pwsh.exe'
    encoded_flags:
        CommandLine|contains:
            - '-e '
            - '-enc '
            - '-encodedcommand '
            - '-EncodedCommand '
    condition: selection and encoded_flags
tags:
    - attack.execution
    - attack.t1059.001
---
title: PowerShell Download Cradle
id: f2234567-ps-cradle-detect-001
status: production
level: high
logsource:
    category: process_creation
    product: windows
detection:
    selection:
        Image|endswith:
            - '\powershell.exe'
            - '\pwsh.exe'
    download_indicators:
        CommandLine|contains:
            - 'IEX'
            - 'Invoke-Expression'
            - 'DownloadString'
            - 'Net.WebClient'
            - 'Start-BitsTransfer'
            - 'Invoke-WebRequest'
            - 'iwr '
    condition: selection and download_indicators
tags:
    - attack.execution
    - attack.t1059.001