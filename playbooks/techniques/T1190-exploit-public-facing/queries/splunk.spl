`comment("=== PB-T1190-001 - Exploit Public-Facing Application Detection ===")`
`comment("MITRE ATT&CK: T1190 - initial-access")`

`comment("SQL Injection Detection")`
index=web sourcetype=access_combined
| rex field=uri "(?<sqli_pattern>union.*select|select.*from|insert.*into|delete.*from|drop.*table|1=1|or.*1.*=.*1|'.*or.*'|--.*$)"
| where isnotnull(sqli_pattern)
| stats count values(uri) as attack_uris by src_ip, dest
| where count > 5

`comment("Log4j/JNDI Exploitation")`
index=web OR index=application
| rex field=_raw "(?<jndi_attack>\$\{jndi:(ldap|rmi|dns|iiop)://)"
| where isnotnull(jndi_attack)
| stats count values(_raw) as payloads by src_ip

`comment("Path Traversal Detection")`
index=web sourcetype=access_combined
| rex field=uri "(?<traversal>\.\./|\.\.\\/|%2e%2e%2f|%252e%252e%252f)"
| where isnotnull(traversal)
| stats count by src_ip, uri