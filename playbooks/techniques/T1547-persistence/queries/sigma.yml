title: Registry Run Keys Persistence
id: a1b2c3d4-1547-4001-8a9b-0c1d2e3f4a5b
status: production
description: Detects modifications to registry run keys for persistence
author: Threat Hunting Team
date: 2025/12/20
references:
  - https://attack.mitre.org/techniques/T1547/001/
tags:
  - attack.persistence
  - attack.t1547.001
logsource:
  category: registry_set
  product: windows
detection:
  selection:
    TargetObject|contains:
      - '\Software\Microsoft\Windows\CurrentVersion\Run'
      - '\Software\Microsoft\Windows\CurrentVersion\RunOnce'
      - '\Software\WOW6432Node\Microsoft\Windows\CurrentVersion\Run'
  filter_legitimate:
    Details|contains:
      - 'C:\Program Files\'
      - 'C:\Program Files (x86)\'
      - 'C:\Windows\System32\'
  condition: selection and not filter_legitimate
falsepositives:
  - Legitimate software installations
level: medium
---
title: Startup Folder Persistence
id: b2c3d4e5-1547-4002-9b0c-1d2e3f4a5b6c
status: production
description: Detects file creation in startup folders
author: Threat Hunting Team
date: 2025/12/20
references:
  - https://attack.mitre.org/techniques/T1547/001/
tags:
  - attack.persistence
  - attack.t1547.001
logsource:
  category: file_event
  product: windows
detection:
  selection:
    TargetFilename|contains: '\Start Menu\Programs\Startup\'
    TargetFilename|endswith:
      - '.exe'
      - '.bat'
      - '.cmd'
      - '.vbs'
      - '.ps1'
      - '.lnk'
  condition: selection
falsepositives:
  - User shortcuts
  - Legitimate applications
level: medium
---
title: Suspicious Scheduled Task Creation
id: c3d4e5f6-1547-4003-0c1d-2e3f4a5b6c7d
status: production
description: Detects creation of scheduled tasks with suspicious commands
author: Threat Hunting Team
date: 2025/12/20
references:
  - https://attack.mitre.org/techniques/T1053/005/
tags:
  - attack.persistence
  - attack.t1547
  - attack.execution
  - attack.t1053.005
logsource:
  product: windows
  service: security
detection:
  selection:
    EventID: 4698
  selection_suspicious:
    TaskContent|contains:
      - 'powershell'
      - 'wscript'
      - 'cscript'
      - 'cmd.exe'
      - 'regsvr32'
      - 'rundll32'
  condition: selection and selection_suspicious
falsepositives:
  - Administrative tasks
  - Software updates
level: high
---
title: WMI Event Subscription Persistence
id: d4e5f6a7-1547-4004-1d2e-3f4a5b6c7d8e
status: production
description: Detects WMI event subscription for persistence
author: Threat Hunting Team
date: 2025/12/20
references:
  - https://attack.mitre.org/techniques/T1546/003/
tags:
  - attack.persistence
  - attack.t1546.003
logsource:
  product: windows
  category: wmi_event
detection:
  selection:
    EventID:
      - 19
      - 20
      - 21
  condition: selection
falsepositives:
  - Legitimate WMI monitoring
  - System management tools
level: high
---
title: Suspicious Service Creation
id: e5f6a7b8-1547-4005-2e3f-4a5b6c7d8e9f
status: production
description: Detects new service creation from suspicious locations
author: Threat Hunting Team
date: 2025/12/20
references:
  - https://attack.mitre.org/techniques/T1543/003/
tags:
  - attack.persistence
  - attack.t1543.003
logsource:
  product: windows
  service: system
detection:
  selection:
    EventID: 7045
  selection_path:
    ImagePath|contains:
      - '\Temp\'
      - '\AppData\'
      - '\Public\'
      - '\ProgramData\'
  condition: selection and selection_path
falsepositives:
  - Rare legitimate services
level: high
